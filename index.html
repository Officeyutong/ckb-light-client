<html>

<head>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.4/dist/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/semantic-ui@2.5.0/dist/semantic.min.css">
    <script src="https://cdn.jsdelivr.net/npm/semantic-ui@2.5.0/dist/semantic.min.js"></script>
    <script type="module">
        import LightClient from "./light-client-js/dist/index.js";

        const testNetConfig = await (await fetch("./test/config.toml")).text();

        console.log(LightClient);
        window.initWorkers = async () => {
            $("#init-button").addClass("loading");
            const client = new LightClient();
            window.client = client;
            await client.start(
                {
                    type: "TestNet",
                    config: testNetConfig,
                },
                "info"
            );

            $("#init-button").removeClass("loading");
        };
        window.doTest = async () => {
            const tx = { "version": 0n, "cellDeps": [{ "outPoint": { "txHash": "0xf8de3bb47d055cdf460d93a2a6e1b05f7432f9777c8c474abf4eec1d4aee5d37", "index": 0n }, "depType": "depGroup" }], "headerDeps": [], "inputs": [{ "previousOutput": { "txHash": "0x8f8c79eb6671709633fe6a46de93c0fedc9c1b8a6527a18d3983879542635c9f", "index": 7n }, "since": 0n }], "outputs": [{ "capacity": 20000000000000000n, "lock": { "codeHash": "0x9bd7e06f3ecf4be0f2fcd2188b23f1b9fcc88e5d4b65a8637b17723bbda3cce8", "hashType": "type", "args": "0xff5094c2c5f476fc38510018609a3fd921dd28ad" } }, { "capacity": 819957834400000000n, "lock": { "codeHash": "0x9bd7e06f3ecf4be0f2fcd2188b23f1b9fcc88e5d4b65a8637b17723bbda3cce8", "hashType": "type", "args": "0x64257f00b6b63e987609fa9be2d0c86d351020fb" } }], "outputsData": ["0x", "0x"], "witnesses": ["0x5500000010000000550000005500000041000000af34b54bebf8c5971da6a880f2df5a186c3f8d0b5c9a1fe1a90c95b8a4fb89ef3bab1ccec13797dcb3fee80400f953227dd7741227e08032e3598e16ccdaa49c00"] };
            console.log(await window.client.sendTransaction(tx));
            console.log(await window.client.estimateCycles(tx));

        };
    </script>

</head>

<body>
    <div style="margin-top: 10%;margin-left: 10%;margin-right: 10%;">
        <button class="ui button" id="init-button" onclick="initWorkers()">Initialize workers</button>
        <div class="ui divider"></div>

    </div>
</body>

</html>
